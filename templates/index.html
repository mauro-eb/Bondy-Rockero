<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bondy Roquero</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        html,body {
            height: 100%;
        }
        .container-fluid {
            padding: 0px;
        }
        #map {
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="container-fluid h-100">
            <div class="row h-100">
                <div class="col-sm-8">
                        <div id="map"></div>
                </div>
                <div class="col-sm-4">
                    <h3>Artista</h3>
                    <div>
                        <input id='input-name' type="text" placeholder="Search an Artist.." name="search">
                        <button id="button-search" type="submit"><i class="fa fa-search"></i></button>
                    </div>
                    <div id='list-event' class="list-group">
                    </div>

                </div>
            </div>
    </div>
</body>
</html>

<script>
    var map;

function myMap() {
    var myLatLng = new google.maps.LatLng(-32.8894587, -68.84583859999998);
    var mapCanvas = document.getElementById("map");
    var mapOptions = {
    center: myLatLng,
    zoom: 10
    };
    map = new google.maps.Map(mapCanvas, mapOptions);

}

$(document).ready(function() {
  $('#button-search').on('click', function(){
      $.get(
        '/performances',
        {
            name: $('#input-name').val()
        },
        function(response){
            data = $.parseJSON(response);

            // For each
            data.performances.forEach(function(element) {
                var myLatLng = new google.maps.LatLng(element.event.venue.latitude, element.event.venue.longitude);
                var marker = new google.maps.Marker({
                    position: myLatLng,
                    map: map,
                    title: element.event.name.text
                });
                $('#list-event').append('<div><a href="' +
                    element.event.url + '#tickets' +
                    '" target="blank" class="list-group-item list-group-item-action">' +
                    element.event.name.text +
                    '</a></div>')
            });
        }
        ).fail(function(){
            alert("Fallo llamada /performances");
        });
  });
})
</script>

<script src="https://maps.googleapis.com/maps/api/js?callback=myMap"></script>